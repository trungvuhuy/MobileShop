<?phpclass ManagementsController extends AppController {	var $name = 'Managements';	var $uses = array('Admin',);		function admin_index() {		mysql_query("SET names utf8");		$this->paginate = array(        	'order'=>'Admin.id DESC','limit' =>20);			$Admin = $this->paginate('Admin');			$this->set('members', $Admin);	 $this->render('/admin/managements/index');					}	function admin_add() {		mysql_query("SET names utf8");		if(!empty($this->data)){				$this->data['Admin']['password']=md5($this->data['Admin']['password']);				if($this->Admin->save($this->data)){					$this->redirect('admin_index');								}		}				 $this->render('/admin/managements/add');	}	function admin_active($id=null) {		$Admin=array('Admin'=>array(									'id'=>$id,									'status'=>1										));		if($this->Admin->save($Admin)){										$name=$_SERVER['HTTP_REFERER'];		$this->redirect($name);		}	}	function admin_close($id=null) {		$Admin=array('Admin'=>array(									'id'=>$id,									'status'=>0										));		if($this->Admin->save($Admin)){										$name=$_SERVER['HTTP_REFERER'];		$this->redirect($name);		}	}		function admin_edit($id=null) {		mysql_query("SET names utf8");		if(!empty($this->data)){				if($this->Admin->save($this->data)){					$this->redirect('admin_index');								}		}		if(empty($this->data)){			$this->data=$this->Admin->read(null,$id);		}				 $this->render('/admin/managements/edit');	}	function admin_chagepass($id=null) {		mysql_query("SET names utf8");		if(!empty($this->data)){			$check=$this->Admin->findById($this->data['Admin']['id']);			if(!empty($check)){				if(md5($this->data['Admin']['passwordOld'])==$check['Admin']['password'] ){					$this->data['Admin']['password']=md5($this->data['Admin']['passNew']);					if($this->Admin->save($this->data)){														echo "<script>alert('Đổi Password  thành công');</script>";							echo "<script>location.href='".DOMAIN."/managements/admin_index'</script>";									}				}				else{					echo "<script>alert('Mật khẩu cũ không đúng, vui lòng kiểm tra lại');</script>";						echo "<script>location.href='".$_SERVER['HTTP_REFERER']."'</script>";					}			}		}		else {			$this->data=$this->Admin->read(null,$id);		}		$this->render('/admin/managements/chagepass');	}	function admin_chagepass___($id=null) {		if(!empty($this->data)){			$check=$this->Admin->findById($this->data['Admin']['id']);			pr($check);die();			if(!empty($check)){						if($this->data['Admin']['passNews']=="" 						  || $this->data['Admin']['passNewsCom']==""						  || $this->data['Admin']['pass']=="" ){							$this->redirect($_SERVER['HTTP_REFERER']);						}else{							if($check['Admin']['password']== md5($this->data['Admin']['pass'])							 && $this->data['Admin']['passNews']== $this->data['Admin']['passNewsCom'])							 {									$this->data['Admin']['password']=md5($this->data['Admin']['passNews']);									///$this->data['Admin']['pass_login']=$this->data['Admin']['passNews'];									//die('vao roi');									if($this->Admin->save($this->data)){																		echo "<script>alert('Đổi Password  thành công');</script>";											echo "<script>location.href='".DOMAIN."/managements/admin_index'</script>";													}					    }		else{				$this->redirect($_SERVER['HTTP_REFERER']);			}					}		}			}	if(empty($this->data)){			$this->data=$this->Admin->read(null,$id);			//pr($this->Admin->read(null,$id));die();					}		 $this->render('/admin/managements/chagepass');	}		}	?>